<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cloud.dao.ShiroUserMapper">
  <resultMap id="BaseResultMap" type="com.cloud.common.entity.activiti.ShiroUser">
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="USER_NAME" jdbcType="VARCHAR" property="userName" />
    <result column="PASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="SALT" jdbcType="VARCHAR" property="salt" />
  </resultMap>

  <sql id="Base_Column_List">
    ID, USER_NAME, PASSWORD, SALT
  </sql>

  <select id="getRoles" parameterType="string" resultType="string">
        SELECT  r.role_name FROM user u
           LEFT JOIN user_role t ON u.id = t.user_id
           LEFT JOIN role r ON t.role_id = r.id
           WHERE u.user_name =  #{userName}
    </select>

  <select id="getPermissions" parameterType="string" resultType="string">
        SELECT  p.permission FROM user u
           LEFT JOIN user_role t ON u.id = t.user_id
           LEFT JOIN role r ON t.role_id = r.id
           LEFT JOIN permission p on r.id = p.role_id
           WHERE u.user_name = #{userName}
    </select>

</mapper>